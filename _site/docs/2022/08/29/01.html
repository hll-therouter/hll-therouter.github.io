<!doctype html>
<html lang="en">

  <head>
  <!-- meta data & title -->
  <meta charset="utf-8">
  <title>TheRouter 基础能力介绍</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="TheRouter 是一个 Kotlin 编写，用于 Android 模块化开发的一整套解决方案框架。">
  <meta name="author" content="TheRouter">
  <meta name="keyword"
      content="TheRouter 基础能力介绍,android,kotlin,arouter,TheRouter">

  <meta name="keywords"
      content="TheRouter 基础能力介绍,android,kotlin,arouter,therouter,studio,优质开发技术">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous"> 
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css">
  <link rel="stylesheet" href="https://cdn.kymjs.com:8843/therouter_assets/css/animate.min.css">
  <link rel="stylesheet" href="https://cdn.kymjs.com:8843/therouter_assets/css/style2.css">
  <link rel="stylesheet" href="https://cdn.kymjs.com:8843/therouter_assets/css/kymjs1.css">
  <link rel="stylesheet" type="text/css" href="https://cdn.kymjs.com:8843/therouter_assets/css/prism.css">

  <script type="text/javascript" src="https://cdn.kymjs.com:8843/therouter_assets/js/prism.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>
</head>
  <script type="text/javascript" src="https://cdn.kymjs.com:8843/therouter_assets/js/jquery-1.10.2.min.js"></script>
<script src="https://cdn.kymjs.com:8843/therouter_assets/js/wow.min.js"></script>
<script>
  new WOW().init();
</script>
  
  <body>
    <div class="container">
  <header class="d-flex flex-wrap justify-content-center py-3 mb-4 border-bottom">
    <a href="/" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto text-dark text-decoration-none">
      <img src="https://cdn.kymjs.com:8843/therouter_assets/img/logo/logo4.png" width="170px">
    </a>

    <ul class="nav nav-pills">
      
      <li class="nav-item">
        
          <a href="/" class="nav-link header-color" aria-current="page">首页</a>
         
      </li>
      <li class="nav-item">
        
          
            <a href="/doc" class="nav-link active header-color">Android</a>
           
         
      </li>
      <li class="nav-item">
        
          <a href="/harmony" class="nav-link header-color">Harmony</a>
         
      </li>
      <li class="nav-item">
        
          <a href="/ios" class="nav-link header-color">iOS</a>
         
      </li>
      <li class="nav-item">
        
          <a href="/docs/2022/08/24/01" class="nav-link header-color">支持</a>
         
      </li>
      <li class="nav-item">
        
          <a href="/about" class="nav-link header-color">关于</a>
         
      </li>
    </ul>
  </header>
</div>


<!-- End Header -->
  	
  		<h2 class="blog-title" align="center">TheRouter 基础能力介绍</h2>
      <br>
  	
    <!-- Main Container -->
<div class="container">
	<div class="blog-post">
		<p><img src="https://cdn.kymjs.com:8843/therouter_assets/img/image/hll.png" class="blog-img" /></p>

<h3 id="功能介绍">功能介绍</h3>

<p>TheRouter 核心功能具备四大能力：</p>

<ul>
  <li>页面导航跳转能力（<a href="https://therouter.cn/docs/2022/08/28/01">Navigator</a>） 页面跳转能力介绍</li>
  <li>跨模块依赖注入能力（<a href="https://therouter.cn/docs/2022/08/27/01">ServiceProvider</a>）跨模块依赖注入</li>
  <li>单模块自动初始化能力 （<a href="https://therouter.cn/docs/2022/08/26/01">FlowTaskExecutor</a>）单模块自动初始化能力介绍</li>
  <li>动态化能力 (<a href="https://therouter.cn/docs/2022/08/25/01">ActionManager</a>) 动态化能力支持</li>
</ul>

<h3 id="一快速上手">一、快速上手</h3>

<h4 id="11-gradle-引入">1.1 Gradle 引入</h4>

<p>最新版本号，请访问：(<a href="https://github.com/HuolalaTech/hll-wp-therouter-android/releases">github/releases</a>)</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 项目根目录 build.gradle 引入</span>
<span class="n">classpath</span> <span class="err">'</span><span class="n">cn</span><span class="o">.</span><span class="na">therouter</span><span class="o">:</span><span class="nl">plugin:</span><span class="mf">1.2</span><span class="o">.</span><span class="mi">2</span><span class="err">'</span>

<span class="c1">// app module 中引入</span>
<span class="n">apply</span> <span class="nl">plugin:</span> <span class="err">'</span><span class="n">therouter</span><span class="err">'</span>

<span class="c1">// 依赖</span>
<span class="n">kapt</span> <span class="s">"cn.therouter:apt:1.2.2"</span>
<span class="n">implementation</span> <span class="s">"cn.therouter:router:1.2.2"</span>
</code></pre></div></div>

<h4 id="12-初始化">1.2 初始化</h4>

<p>框架内部包含自动初始化功能，详见<a href="https://therouter.cn/docs/2022/08/26/01">单模块自动初始化能力</a><br />
无需任何初始化代码。但推荐你根据业务设置否为<code class="language-plaintext highlighter-rouge">Debug</code>环境，用以查看日志信息。<br />
<code class="language-plaintext highlighter-rouge">Application.attachBaseContext()</code> 方法中尽可能早设置当前是否为<code class="language-plaintext highlighter-rouge">Debug</code>环境。</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Override</span>
<span class="kd">protected</span> <span class="kt">void</span> <span class="nf">attachBaseContext</span><span class="o">(</span><span class="nc">Context</span> <span class="n">base</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">TheRouter</span><span class="o">.</span><span class="na">setDebug</span><span class="o">(</span><span class="kc">true</span> <span class="n">or</span> <span class="kc">false</span><span class="o">);</span>
    <span class="kd">super</span><span class="o">.</span><span class="na">attachBaseContext</span><span class="o">(</span><span class="n">base</span><span class="o">);</span>  
<span class="o">}</span>
</code></pre></div></div>

<h4 id="13-页面参数注入">1.3 页面参数注入</h4>

<p>在<code class="language-plaintext highlighter-rouge">Activity</code> 或 <code class="language-plaintext highlighter-rouge">Fragment</code> 的 <code class="language-plaintext highlighter-rouge">onCreate()</code>方法中调用，建议直接在<code class="language-plaintext highlighter-rouge">BaseActivity(BaseFragment)</code>中做</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Override</span>
<span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="nd">@Nullable</span> <span class="nc">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
    <span class="nc">TheRouter</span><span class="o">.</span><span class="na">inject</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<h4 id="14-页面跳转">1.4 页面跳转</h4>

<p>关于注解<code class="language-plaintext highlighter-rouge">@Route</code>的参数含义，请查看文档：<a href="https://therouter.cn/docs/2022/08/28/01">页面导航跳转能力</a></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Route</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">"http://therouter.com/home"</span><span class="o">,</span> <span class="n">action</span> <span class="o">=</span> <span class="s">"action://scheme.com"</span><span class="o">,</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s">"第二个页面"</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="o">{</span><span class="s">"hello"</span><span class="o">,</span> <span class="s">"world"</span><span class="o">})</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">HomeActivity</span> <span class="kd">extends</span> <span class="nc">BaseActivity</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="nd">@Nullable</span> <span class="nc">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
        <span class="nc">TheRouter</span><span class="o">.</span><span class="na">build</span><span class="o">(</span><span class="s">"要跳转的目标页Path"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">withInt</span><span class="o">(</span><span class="s">"intValue"</span><span class="o">,</span> <span class="mi">12345678</span><span class="o">)</span> <span class="c1">// 传 int 值</span>
            <span class="o">.</span><span class="na">withString</span><span class="o">(</span><span class="s">"str_123_Value"</span><span class="o">,</span> <span class="s">"传中文字符串"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">withBoolean</span><span class="o">(</span><span class="s">"boolValue"</span><span class="o">,</span> <span class="kc">true</span><span class="o">)</span> 
            <span class="o">.</span><span class="na">withLong</span><span class="o">(</span><span class="s">"longValue"</span><span class="o">,</span> <span class="mi">123456789012345L</span><span class="o">)</span>
            <span class="o">.</span><span class="na">withChar</span><span class="o">(</span><span class="s">"charValue"</span><span class="o">,</span> <span class="sc">'c'</span><span class="o">)</span> 
            <span class="o">.</span><span class="na">withDouble</span><span class="o">(</span><span class="s">"double"</span><span class="o">,</span> <span class="mf">3.14159265358972</span><span class="o">)</span>
            <span class="o">.</span><span class="na">withFloat</span><span class="o">(</span><span class="s">"floatValue"</span><span class="o">,</span> <span class="mf">3.14159265358972</span><span class="no">F</span><span class="o">)</span>
            <span class="o">.</span><span class="na">navigation</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="二编译器配置">二、编译器配置</h3>

<p>可在<code class="language-plaintext highlighter-rouge">local.properties</code>配置编译期属性（warning输出日志，error直接报错）<br />
从 <code class="language-plaintext highlighter-rouge">1.2.3-rc1</code>版本开始，编译器配置已经迁移到<code class="language-plaintext highlighter-rouge">build.gradle</code>中，具体请查看：<a href="https://therouter.cn/docs/2024/07/22/01">1.2.3版本编译改动</a></p>

<ul>
  <li><strong>增量编译开关</strong><br />
开启增量编译能大幅加快编译速度，但在删除旧代码时，可能需要clean后重新编译，否则会报错。<br />
<code class="language-plaintext highlighter-rouge">THEROUTER_OPEN_INCREMENTAL=true</code> （true/false可选，默认是false）</li>
  <li><strong>路由表未知<code class="language-plaintext highlighter-rouge">Activity</code>检测</strong><br />
路由表中如果声明了一个不存在的<code class="language-plaintext highlighter-rouge">Activity</code>，通常是因为旧代码删除时忘记清理路由表了，这里可选报错或警告，提供参考。<br />
 <code class="language-plaintext highlighter-rouge">CHECK_ROUTE_MAP=warning</code> （warning/error可选，不加则不会执行检测）</li>
  <li><strong>初始化任务未知依赖检查</strong><br />
<code class="language-plaintext highlighter-rouge">@FlowTask</code>的<code class="language-plaintext highlighter-rouge">dependsOn</code>参数声明了一个不存在的任务，通常情况下是由于任务名书写错误，建议设置为error，尽早在编译期发现问题。
<code class="language-plaintext highlighter-rouge">CHECK_FLOW_UNKNOW_DEPEND=warning</code> （warning/error可选，不加则不会执行检测）</li>
</ul>

<h3 id="三混淆配置">三、混淆配置</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># 如果使用了 Fragment 路由，需要保证类名不被混淆
# -keep public class * extends android.app.Fragment
# -keep public class * extends androidx.fragment.app.Fragment
# -keep public class * extends android.support.v4.app.Fragment

-keep class androidx.annotation.Keep
-keep @androidx.annotation.Keep class * {*;}
-keepclassmembers class * {
    @androidx.annotation.Keep *;
}
-keepclasseswithmembers class * {
    @androidx.annotation.Keep &lt;methods&gt;;
}
-keepclasseswithmembers class * {
    @androidx.annotation.Keep &lt;fields&gt;;
}
-keepclasseswithmembers class * {
    @androidx.annotation.Keep &lt;init&gt;(...);
}
-keepclasseswithmembers class * {
    @com.therouter.router.Autowired &lt;fields&gt;;
}
</code></pre></div></div>

<h3 id="四从其他路由迁移至-therouter">四、从其他路由迁移至 TheRouter</h3>

<h4 id="41-迁移工具一键迁移">4.1 迁移工具一键迁移</h4>

<p>可使用迁移工具一键迁移：</p>

<ul>
  <li>Mac OS 迁移工具：<a href="https://github.com/HuolalaTech/hll-wp-therouter-android/wiki/uploads/file/TheRouterTransfer-Mac.zip">https://github.com/HuolalaTech/hll-wp-therouter-android/wiki/uploads/file/TheRouterTransfer-Mac.zip</a></li>
  <li>Windows 迁移工具：<a href="https://github.com/HuolalaTech/hll-wp-therouter-android/wiki/uploads/file/TheRouterTransfer-Windows.zip">https://github.com/HuolalaTech/hll-wp-therouter-android/wiki/uploads/file/TheRouterTransfer-Windows.zip</a></li>
</ul>

<p>如果项目中使用了<code class="language-plaintext highlighter-rouge">ARouter</code>的<code class="language-plaintext highlighter-rouge">IProvider.init()</code>方法，可能需要手动处理初始化逻辑。</p>

<p>如下图：</p>

<p><img src="https://cdn.kymjs.com:8843/therouter_assets/img/image/TheRouterTransfer.png" class="blog-img" /></p>

<h3 id="五源码运行与调试">五、源码运行与调试</h3>

<h4 id="51-工程模块描述">5.1 工程模块描述</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>TheRouter
  ├─app
  │   └──代码使用示例Demo
  ├─business-a
  │   └──用于模块化业务模块的演示模块
  ├─business-b
  │   └──用于模块化业务模块的演示模块
  ├─business-base
  │   └──用于模块化基础模块的演示模块
  ├─apt
  │   └──注解处理器相关代码
  ├─plugin
  │   └──编译期 Gradle 插件源码
  └─router
      └──路由库核心代码
</code></pre></div></div>

<h4 id="52-项目运行">5.2 项目运行</h4>

<ol>
  <li>打开<code class="language-plaintext highlighter-rouge">local.properties</code>，声明你想要调试的模块
 例如希望源码调试<code class="language-plaintext highlighter-rouge">apt</code>模块，则声明<code class="language-plaintext highlighter-rouge">apt=true</code>即可</li>
  <li>同步 Gradle 变更</li>
</ol>

<h4 id="53-plugin-源码调试">5.3 plugin 源码调试</h4>

<p><code class="language-plaintext highlighter-rouge">plugin</code>调试比较特殊，需要修改<code class="language-plaintext highlighter-rouge">module</code>名。</p>

<ol>
  <li>修改<code class="language-plaintext highlighter-rouge">plugin</code>文件夹名为<code class="language-plaintext highlighter-rouge">buildSrc</code>（注意大小写）</li>
  <li>注释根目录<code class="language-plaintext highlighter-rouge">build.gradle</code>中的<code class="language-plaintext highlighter-rouge">classpath</code>引用（不需要了）</li>
  <li>同步 Gradle 变更</li>
</ol>


	</div>
  
  
  
    
  
    
    

    
      <h3>相关推荐：</h3>
      <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-3">
    
    
    <div class="col">
      <div class="card shadow-sm">
        <a href=/docs/2025/05/14/01>
          <svg class="bd-placeholder-img card-img-top" width="100%" height="125" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder: Thumbnail" preserveAspectRatio="xMidYMid slice" focusable="false"><title>鸿蒙路由源码调试步骤</title><rect width="100%" height="100%" fill="#55595c"></rect><text x="5%" y="50%" fill="#eceeef" dy=".3em">鸿蒙路由源码调试步骤</text></svg>
        </a>

        <div class="card-body">
          <p class="card-text">
            
              本文已迁移至：https://kymjs.com/code/2025/03/23/01/


            
          </p>
          <div class="d-flex justify-content-between align-items-center">
            <div class="btn-group">
              <a href=/docs/2025/05/14/01>
                <button type="button" class="btn btn-sm btn-outline-secondary">阅读</button>
              </a>
            </div>
            <small class="text-muted">1 mins</small>
          </div>
        </div>
      </div>
    </div>
    
    
  
    
  
    
    

    
    
    <div class="col">
      <div class="card shadow-sm">
        <a href=/docs/2025/03/23/01>
          <svg class="bd-placeholder-img card-img-top" width="100%" height="125" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder: Thumbnail" preserveAspectRatio="xMidYMid slice" focusable="false"><title>从零接入鸿蒙路由 TheRouter</title><rect width="100%" height="100%" fill="#55595c"></rect><text x="5%" y="50%" fill="#eceeef" dy=".3em">从零接入鸿蒙路由 TheRouter</text></svg>
        </a>

        <div class="card-body">
          <p class="card-text">
            
              `TheRouter` 是货拉拉基于HMRouter深度定制的开源路由框架，提供了 Android、iOS、Harmony 三端高一致性使用，在支持平台化...
            
          </p>
          <div class="d-flex justify-content-between align-items-center">
            <div class="btn-group">
              <a href=/docs/2025/03/23/01>
                <button type="button" class="btn btn-sm btn-outline-secondary">阅读</button>
              </a>
            </div>
            <small class="text-muted">4 mins</small>
          </div>
        </div>
      </div>
    </div>
    
    
  
    
    

    
    
    <div class="col">
      <div class="card shadow-sm">
        <a href=/docs/2024/10/31/01>
          <svg class="bd-placeholder-img card-img-top" width="100%" height="125" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder: Thumbnail" preserveAspectRatio="xMidYMid slice" focusable="false"><title>为 TheRouter 的 AGP8 编译加个速</title><rect width="100%" height="100%" fill="#55595c"></rect><text x="5%" y="50%" fill="#eceeef" dy=".3em">为 TheRouter 的 AGP8 编译加个速</text></svg>
        </a>

        <div class="card-body">
          <p class="card-text">
            
              内容请见： 

《为 TheRouter 的 AGP8 编译加个速》  
[https://kymjs.com/code/2024/10/31/01/](...
            
          </p>
          <div class="d-flex justify-content-between align-items-center">
            <div class="btn-group">
              <a href=/docs/2024/10/31/01>
                <button type="button" class="btn btn-sm btn-outline-secondary">阅读</button>
              </a>
            </div>
            <small class="text-muted">1 mins</small>
          </div>
        </div>
      </div>
    </div>
    
    
  
    
    

    
      
  
    </div>
  

</div>
<!--End Main Container -->

  </body>

  <!-- Footer -->
<footer> 
  <div class="container">
    <div class="row">
      <div class="col-md-4">
        <h3><i class="bi bi-link-45deg bi-footer"></i> 友情链接</h3>
        <p><a href="https://www.huolala.cn/"> 货拉拉</a></p>
        <p><a href="https://www.huolala.cn/house_move.html"> 无忧搬家</a></p>
        <p><a href="https://www.xiaolachuxing.com/"> 小拉出行</a></p>
      </div>
      <div class="col-md-4">
        <h3><i class="bi bi-slack bi-footer"></i> 社区</h3>
        <p><a href="https://therouter.cn/docs/2022/08/24/01"> 官方微信群 </a></p>
        <p><a href="https://kymjs.com"> 开源实验室</a></p>
        <p><a href="https://1-0.top"> 零一开源 </a></p>
      </div>
      <div class="col-md-4">
        <h3><i class="bi bi-postcard-heart bi-footer"></i> 关于</h3>
        <p><a href="https://juejin.cn/user/1768489241815070/posts"> 货拉拉移动技术团队</a></p>
        <p><a href="https://github.com/HuolalaTech"> GitHub </a></p>
      </div>    
    </div>
  </div>

  <div class="copyright text center">
    <p>&copy; Copyright 2025, <a href="#">TheRouter</a>. <br>Theme ported by <a href="https://melvinchng.github.io/" target="_blank">Melvin Ch'ng</a></p>
  </div>
</footer>
</html>
